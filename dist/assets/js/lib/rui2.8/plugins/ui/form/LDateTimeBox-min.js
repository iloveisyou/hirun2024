/*
 * @(#) LDateTimeBox-min.js
 * 
 * DevOn RUI
 * Build Version : 2.8
 * 
 * Copyright ⓒ LG CNS, Inc. All rights reserved.
 *
 * DevOn RUI의 모든 저작물은 LG CNS 의 지적재산입니다.
 * LG CNS로 부터 허가 받지 않은 경우 사용, 열람, 복사, 수정, 재배포 할 수 없으며 외부로의 유출을 금지합니다.
 * 특히 소스 코드를 수정하는 경우 기술 지원의 대상이 되지 않을 수 있습니다.
 * 자세한 사항은 계약사항에 따릅니다. 기타 사항은 devon@lgcns.com 으로 문의 하십시오.
 *
 * Do Not Erase This Comment!!! (이 주석문을 지우지 말것)
 *
 * rui/license.txt를 반드시 읽어보고 사용하시기 바랍니다. License.txt파일은 절대로 삭제하시면 안됩니다. 
 *
 * 1. 사내 사용시 KAMS를 통해 요청하여 사용허가를 받으셔야 소프트웨어 라이센스 계약서에 동의하는 것으로 간주됩니다.
 * 2. DevOn RUI가 포함된 제품을 판매하실 경우에도 KAMS를 통해 요청하여 사용허가를 받으셔야 합니다.
 * 3. KAMS를 통해 사용허가를 받지 않은 경우 소프트웨어 라이센스 계약을 위반한 것으로 간주됩니다.
 * 4. 별도로 판매될 경우는 LGCNS의 소프트웨어 판매정책을 따릅니다.
 */
!function(){Rui.ui.form.LDateTimeBox=function(t){t=Rui.applyIf(t||{},Rui.getConfig().getFirst("$.ext.datetimeBox.defaultProperties")),Rui.ui.form.LDateTimeBox.superclass.constructor.call(this,t)};var n="%Y%m%d%H%M%S";Rui.extend(Rui.ui.form.LDateTimeBox,Rui.ui.form.LField,{otype:"Rui.ui.form.LDateTimeBox",CSS_BASE:"L-datetimebox",valueFormat:"%Y-%m-%d %H:%M:%S",dateType:"date",dateBoxWidth:90,timeBoxWidth:50,datePlaceholder:null,timePlaceholder:null,checkContainBlur:!0,dateDefaultValue:null,timeDefaultValue:null,dateDisabled:!1,timeDisabled:!1,doRender:function(){var t=Rui.get(this.el);t.addClass(this.CSS_BASE),t.addClass("L-fixed"),t.addClass("L-form-field");var e=this.el.id||Rui.id(),i=document.createElement("input");i.type="hidden",i.id=Rui.useFixedId()?Rui.id(this.el,"LDateTimeBox-hidden-"+this.id):Rui.id(),i.name=this.name||this.id,i.instance=this,i.className="L-instance L-hidden-field",this.el.appendChild(i),this.hiddenInputEl=Rui.get(i),this.hiddenInputEl.addClass("L-hidden-field"),this.dateBoxId=e+"DateBox",this.timeBoxId=e+"TimeBox";var s,a='<input type="text" id="'+this.dateBoxId+'"> <input type="text" id="'+this.timeBoxId+'">';t.appendChild(a),this.width>this.dateBoxWidth+this.timeBoxWidth&&(s=this.el.getBorderWidth("lr"),this.dateBoxWidth=.7*this.width-(s||2),this.timeBoxWidth=.3*this.width-(s||2))},afterRender:function(t){var e={applyTo:this.dateBoxId,emptyValue:"",dateType:"string",valueFormat:"%Y%m%d",placeholder:this.datePlaceholder,width:this.dateBoxWidth,defaultValue:this.dateDefaultValue,disabled:this.dateDisabled};this.dateBox=new Rui.ui.form.LDateBox(e);var i={applyTo:this.timeBoxId,emptyValue:"",placeholder:this.timePlaceholder,width:this.timeBoxWidth,defaultValue:this.timeDefaultValue,disabled:this.timeDisabled};this.timeBox=new Rui.ui.form.LTimeBox(i),this.dateBox.on("changed",this.onDateBoxChanged,this,!0),this.dateBox.on("specialkey",this.onFireKey,this,!0),this.dateBox.on("focus",this.onCheckFocus,this,!0),this.dateBox.on("blur",this.deferOnBlur,this,!0),this.dateBox.on("invalid",this.onInvalid,this,!0),this.timeBox.on("changed",this.onTimeBoxChanged,this,!0),this.timeBox.on("focus",this.onCheckFocus,this,!0),this.timeBox.on("blur",this.deferOnBlur,this,!0),this.timeBox.on("specialkey",this.onFireKey,this,!0),this.timeBox.on("invalid",this.onInvalid,this,!0)},onDateBoxChanged:function(t){var e=(e=this.timeBox.getValue())||(Rui.platform.isMobile?"00:00":"0000");this.timeBox.setValue(e,!0);var i=(this.dateBox.getValue()+e+(this.sec||"00")).toDate(n),s=this.dateBox.getDisplayValue()+" "+e.substring(0,2)+":"+e.substring(2,4);1!=this._isDateEvent&&!Rui.isUndefined(this._isDateEvent)||this.fireEvent("changed",{target:this,value:i,displayValue:s})},onTimeBoxChanged:function(t){var e=this.dateBox.getValue(),i=this.timeBox.getValue();(i=i&&i.replace(":",""))&&!e&&this.dateBox.setValue(new Date,!0);var s=(e+i+(this.sec||"00")).toDate(n),a=this.dateBox.getDisplayValue()+" "+i.substring(0,2)+":"+i.substring(2,4);1!=this._isTimeEvent&&!Rui.isUndefined(this._isTimeEvent)||this.fireEvent("changed",{target:this,value:s,displayValue:a})},onInvalid:function(t){this.invalid({type:"invalid",message:t})},_setEditable:function(t,e,i){var s=!!e[0];this.dateBox.setEditable(s),this.timeBox.setEditable(s)},_setDisabled:function(t,e,i){e[0]!==this.disabled?(this.disabled=!!e[0],!1===this.disabled?(this.dateBox.enable(),this.timeBox.enable()):(this.dateBox.disable(),this.timeBox.disable())):void 0===this.dateBox&&void 0===this.timeBox&&!0===this.disabled&&(this.dateDisabled=!0,this.timeDisabled=!0)},_setHeight:function(t,e,i){Rui.ui.form.LDateTimeBox.superclass._setHeight.call(this,t,e,i);var s=this.getContentHeight();this.dateBox.setHeight(s),this.timeBox.setHeight(s)},onSpecialkey:function(t){this.fireEvent("specialkey",t)},getDateValue:function(){var t=this.getStringValue();return t?Rui.util.LDate.parse(t,{format:n}):null},getStringValue:function(){var t=this.dateBox.getValue(),e=this.timeBox.getValue();return t&&e?t+(e+=this.sec||"00"):null},setValue:function(t,e){t&&Rui.isString(t)&&(t=Rui.util.LFormat.stringToDate(t,{format:this.valueFormat}));var i=null,s=null,a=null,d=null;if(t){var h=Rui.util.LDate.format(t,{format:n}),i=h.substring(0,8),s=h.substring(8,12),o=h.substring(12);if(void 0!==this.dateBox&&void 0!==this.timeBox&&(a=this.dateBox.getValue(),d=this.timeBox.getValue()),i+s==a+d)return;s==d?(this._isDateEvent=!0,this._isTimeEvent=!1):(this._isDateEvent=!1,this._isTimeEvent=!0)}void 0!==this.dateBox&&void 0!==this.timeBox?(this.dateBox.setValue(i,e),this.timeBox.setValue(s,e)):(this.dateDefaultValue=i,this.timeDefaultValue=s);var l="";t&&(l=Rui.util.LDate.format(t,{format:this.valueFormat})),this.hiddenInputEl.setValue(l),this.sec=o,delete this._isDateEvent,delete this._isTimeEvent},getValue:function(){var t=this.getDateValue();return t?"date"===this.dateType?Rui.isString(t)?Rui.util.LString.toDate(t,n):t:Rui.util.LDate.format(t,{format:this.valueFormat}):null},focus:function(){this.dateBox.focus()},blur:function(){this.dateBox.blur()},deferOnBlur:function(t){var e,i;this.calendarDivEl&&this.calendarDivEl.isAncestor(t.target)&&("a"==(e=Rui.get(t.target)).dom.tagName.toLowerCase()&&e.hasClass("selector")&&(i=this.calendar.getProperty("pagedate"),i=new Date(i.getFullYear(),i.getMonth(),parseInt(e.getHtml())),this.setValue(i),this.calendar&&this.calendar.hide())),Rui.util.LFunction.defer(this.checkBlur,10,this,[t])},checkBlur:function(t){var e;1!=t.deferCancelBubble&&!0===this.isFocus&&((e=t.target)===this.el.dom||this.el.isAncestor(e)||this.calendarDivEl&&(e===this.calendarDivEl.dom||this.calendarDivEl.isAncestor(e))?t.deferCancelBubble=!0:(Rui.util.LEvent.removeListener(Rui.browser.msie?document.body:document,"mousedown",this.deferOnBlur),this.isFocus=!1))},destroy:function(){this.dateBox&&this.dateBox.destroy(),this.timeBox&&this.timeBox.destroy(),Rui.ui.form.LDateTimeBox.superclass.destroy.call(this)}})}();