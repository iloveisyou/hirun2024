/*
 * @(#) LUnorderedListNode-min.js
 * 
 * DevOn RUI
 * Build Version : 2.8
 * 
 * Copyright ⓒ LG CNS, Inc. All rights reserved.
 *
 * DevOn RUI의 모든 저작물은 LG CNS 의 지적재산입니다.
 * LG CNS로 부터 허가 받지 않은 경우 사용, 열람, 복사, 수정, 재배포 할 수 없으며 외부로의 유출을 금지합니다.
 * 특히 소스 코드를 수정하는 경우 기술 지원의 대상이 되지 않을 수 있습니다.
 * 자세한 사항은 계약사항에 따릅니다. 기타 사항은 devon@lgcns.com 으로 문의 하십시오.
 *
 * Do Not Erase This Comment!!! (이 주석문을 지우지 말것)
 *
 * rui/license.txt를 반드시 읽어보고 사용하시기 바랍니다. License.txt파일은 절대로 삭제하시면 안됩니다. 
 *
 * 1. 사내 사용시 KAMS를 통해 요청하여 사용허가를 받으셔야 소프트웨어 라이센스 계약서에 동의하는 것으로 간주됩니다.
 * 2. DevOn RUI가 포함된 제품을 판매하실 경우에도 KAMS를 통해 요청하여 사용허가를 받으셔야 합니다.
 * 3. KAMS를 통해 사용허가를 받지 않은 경우 소프트웨어 라이센스 계약을 위반한 것으로 간주됩니다.
 * 4. 별도로 판매될 경우는 LGCNS의 소프트웨어 판매정책을 따릅니다.
 */
Rui.ui.LUnorderedListNode||(Rui.ui.LUnorderedListNode=function(t){Rui.applyObject(this,t),this.init()},Rui.ui.LUnorderedListNode.prototype={el:null,otype:"Rui.ui.LUnorderedListNode",recordId:null,idValue:null,depth:null,dom:null,isLeaf:null,unorderList:null,NODE_STATE:null,useAnimation:!1,useCollapseAllSibling:!1,childULHeight:0,init:function(){this.dom="li"==this.dom.tagName.toLowerCase()?this.dom.firstChild:this.dom,this.el=Rui.get(this.dom),this.NODE_STATE=this.unorderList.NODE_STATE,this.recordId=this.unorderList.getRecordId(this.dom);var t=Rui.util.LDom.findStringInClassName(this.dom,this.unorderList.CLASS_UL_LI_DIV_DEPTH+"-");this.depth="null"!=t&&parseInt(t),this.initIsLeaf()},initIsLeaf:function(){var t=!0,s=this.unorderList.dataSet.get(this.recordId);if(s)if(this.unorderList.fields.hasChild){var e=s.get(this.unorderList.fields.hasChild);null!=this.unorderList.hasChildValue&&(e=e==this.unorderList.hasChildValue),t=!e}else for(var i=s.get(this.unorderList.fields.id),r=this.unorderList.dataSet.getCount(),h=0;h<r;h++)if(this.unorderList.dataSet.getAt(h).get(this.unorderList.fields.parentId)===i){t=!1;break}this.isLeaf=t},getRecordId:function(){return this.recordId},getParentId:function(){var t=this.getRecord();return t?t.get(this.unorderList.fields.parentId):void 0},getParentNode:function(){if(0<this.getDepth()){var t=this.getParentDom();if(t)return this.unorderList.createNodeObject(t)}return!1},getIdValue:function(){var t=this.getRecord();return this.idValue=t?t.get(this.unorderList.fields.id):void 0,this.idValue},getRecord:function(){return this.unorderList.dataSet.get(this.getRecordId())},getRow:function(){return this.unorderList.dataSet.indexOfKey(this.getRecordId())},getDepth:function(){return this.depth},hasChild:function(){return!this.isLeaf},isFocus:function(){return this.checkNodeState(this.NODE_STATE.FOCUS)},focus:function(){this.changeStateTo(this.NODE_STATE.FOCUS),this.isTop()&&this.changeStateTo(this.NODE_STATE.FOCUS_TOP)},unfocus:function(){this.changeStateTo(this.NODE_STATE.UNFOCUS)},isMarked:function(){return this.checkNodeState(this.NODE_STATE.MARK)},mark:function(){this.changeStateTo(this.NODE_STATE.MARK),"child"==this.getRecord().treeType?this.unorderList.markChilds(!0,this.getRecord()):"parent"==this.getRecord().treeType&&this.unorderList.markParents(!0,this)},unmark:function(){this.changeStateTo(this.NODE_STATE.UNMARK),"child"==this.getRecord().treeType?this.unorderList.markChilds(!1,this.getRecord()):"parent"==this.getRecord().treeType&&this.unorderList.markParents(!1,this)},isLast:function(){return this.checkNodeState(this.NODE_STATE.last)},isTop:function(){return 0==this.depth},isExpand:function(){return this.checkNodeState(this.NODE_STATE.OPEN)},isCollaps:function(){return this.checkNodeState(this.NODE_STATE.CLOSE)},open:function(t){var s=new Array;t&&this.removeChildUL(void 0,t),s=this.unorderList.getChildNodeInfos(this.getIdValue(),null,this.getParentDoms(),t),t||0!=s.length?this.renderChild(s,t):this.unorderList.fireEvent("dynamicLoadChild",{target:this.unorderList,node:this,parentId:this.getIdValue()}),(this.useCollapseAllSibling||0===this.getDepth()&&!0===this.unorderList.onlyOneTopOpen)&&this.collapseAllSibling()},renderChild:function(t,s){0<t.length?(this.addChildNodes(t,s),this.changeStateTo(this.NODE_STATE.OPEN)):this.changeStateTo(this.NODE_STATE.HAS_NO_CHILD)},close:function(){this.changeStateTo(this.NODE_STATE.CLOSE),this.removeChildUL()},syncLabel:function(){this.el.html(this.unorderList.getContent(this.getRecord()))},toggleChild:function(){this.isExpand()?this.close():this.isCollaps()&&this.open()},expand:function(){this.isCollaps()&&this.open()},collapse:function(){this.isExpand()&&this.close()},collapseAllSibling:function(){for(var t=this.getUL(),s=0;s<t.childNodes.length;s++)t.childNodes[s].firstChild!==this.dom&&this.unorderList.getNodeObject(t.childNodes[s]).collapse()},getOrder:function(){return this.unorderList.fields.order?this.getRecord().get(this.unorderList.fields.order):null},getChildUL:function(t){return this.unorderList.getChildUL(t||this.dom)},getChildULHeight:function(){return this.childULHeight},removeChildUL:function(t,s){var e,i,r,h=this.getChildUL(t);h&&(e=this.getLi(),s||!this.useAnimation||!0!==this.useAnimation&&!0!==this.useAnimation.collapse?(e.style.overflow="hidden",e.removeChild(h),this.unorderList.fireEvent("collapse",{target:this,node:this.unorderList.currentFocus}),e.style.overflow=""):(e.style.overflow="hidden",i=new Rui.fx.LAnim({el:h,attributes:{height:{to:1}},duration:this.unorderList.animDuration}),r=this,i.on("complete",function(){e.removeChild(h),r.unorderList.fireEvent("collapse",{target:r,node:r.unorderList.currentFocus}),e.style.overflow=""}),i.animate()))},getUL:function(t){return this.unorderList.getUL(t||this.dom)},getIndex:function(){for(var t=this.getUL(),s=this.getLi(),e=-1,i=0;i<t.childNodes.length;i++)if(s===t.childNodes[i]){e=i;break}return e},getLi:function(t){return(t=t||this.dom).parentNode},getParentLi:function(t){var s=(t=t||this.dom).parentNode.parentNode.parentNode;return s=s&&s.tagName&&"li"==s.tagName.toLowerCase()?s:null},getPreviousLi:function(t){t=t||this.dom;var s=this.getLi(t);return Rui.util.LDom.getPreviousSibling(s)},getNextLi:function(t){t=t||this.dom;var s=this.getLi(t);return Rui.util.LDom.getNextSibling(s)},getNextDom:function(t){t=t||this.dom;var s=this.getNextLi(t),e=null;return s&&(e=(e=s.firstChild)&&e.tagName&&"div"==e.tagName.toLowerCase()?e:null),e},getPreviousDom:function(t){t=t||this.dom;var s=this.getPreviousLi(t),e=null;return s&&(e=(e=s.firstChild)&&e.tagName&&"div"==e.tagName.toLowerCase()?e:null),e},getLastChildDom:function(){var t=this.getChildUL();return t?t.lastChild.firstChild:null},getParentDom:function(t){t=t||this.dom;var s=this.getParentLi(t),e=null;return s&&(e=(e=s.firstChild)&&e.tagName&&"div"==e.tagName.toLowerCase()?e:null),e},getParentDoms:function(t){var s=new Array,e=this.dom;!0!==t&&s.push(e);for(var i=0;i<100&&(e=this.getParentDom(e));i++)s.push(e);return s},addChildNodes:function(t,s){var e,i,r,h,L;t&&0<t.length&&(this.changeStateTo(this.NODE_STATE.HAS_CHILD),this.isLeaf=!1,e=this.unorderList.htmlToDom(this.unorderList.getUlHtml(null,this.depth,t)),i=Rui.get(e),s&&this.isExpand()||i.setStyle("display","none"),this.el.parent().appendChild(e),r=i.getDimensions(),this.childULHeight=r.height,s&&this.isExpand()||(!this.useAnimation||!0!==this.useAnimation&&!0!==this.useAnimation.expand?(i.setStyle("display",""),i.setStyle("overflow","hidden"),i.setStyle("height","auto"),this.unorderList.fireEvent("expand",{target:this,node:this.unorderList.currentFocus}),i.setStyle("overflow","")):(i.setStyle("height","1px"),i.setStyle("display",""),i.setStyle("overflow","hidden"),(h=new Rui.fx.LAnim({el:e,attributes:{height:{from:1,to:r.height}}})).duration=this.unorderList.animDuration,h.animate(),L=this,h.on("complete",function(){i.setStyle("height","auto"),L.unorderList.fireEvent("expand",{target:L,node:L.unorderList.currentFocus}),i.setStyle("overflow","")}))))},getChildNodes:function(){var t=[];return this.unorderList&&(t=this.unorderList.getChildRecords(this.getIdValue(),this.childDataSet)),t},checkNodeState:function(t){switch(t){case this.NODE_STATE.HAS_CHILD:return this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_CLOSE_LAST)||this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_CLOSE_MID)||this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_OPEN_LAST)||this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_OPEN_MID);case this.NODE_STATE.HAS_NO_CHILD:return this.el.hasClass(this.unorderList.CLASS_UL_HAS_NO_CHILD_MID)||this.el.hasClass(this.unorderList.CLASS_UL_HAS_NO_CHILD_LAST);case this.NODE_STATE.MID:return this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_CLOSE_MID)||this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_OPEN_MID)||this.el.hasClass(this.unorderList.CLASS_UL_HAS_NO_CHILD_MID);case this.NODE_STATE.LAST:return this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_CLOSE_LAST)||this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_OPEN_LAST)||this.el.hasClass(this.unorderList.CLASS_UL_HAS_NO_CHILD_LAST);case this.NODE_STATE.OPEN:return this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_OPEN_MID)||this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_OPEN_LAST);case this.NODE_STATE.CLOSE:return this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_CLOSE_LAST)||this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_CLOSE_MID);case this.NODE_STATE.MARK:return this.el.hasClass(this.unorderList.CLASS_UL_MARKED_NODE);case this.NODE_STATE.UNMARK:return!this.el.hasClass(this.unorderList.CLASS_UL_MARKED_NODE);case this.NODE_STATE.FOCUS:return this.el.hasClass(this.unorderList.CLASS_UL_FOCUS_NODE);case this.NODE_STATE.UNFOCUS:return!this.el.hasClass(this.unorderList.CLASS_UL_FOCUS_NODE);default:return!1}},changeStateTo:function(t){switch(t){case this.NODE_STATE.HAS_CHILD:this.el.hasClass(this.unorderList.CLASS_UL_HAS_NO_CHILD_MID)?(this.el.replaceClass(this.unorderList.CLASS_UL_HAS_NO_CHILD_MID,this.unorderList.CLASS_UL_HAS_CHILD_OPEN_MID),Rui.get(this.getLi()).addClass(this.unorderList.CLASS_UL_LI_LINE)):this.el.hasClass(this.unorderList.CLASS_UL_HAS_NO_CHILD_LAST)&&this.el.replaceClass(this.unorderList.CLASS_UL_HAS_NO_CHILD_LAST,this.unorderList.CLASS_UL_HAS_CHILD_OPEN_LAST);break;case this.NODE_STATE.HAS_NO_CHILD:this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_CLOSE_MID)?this.el.replaceClass(this.unorderList.CLASS_UL_HAS_CHILD_CLOSE_MID,this.unorderList.CLASS_UL_HAS_NO_CHILD_MID):this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_CLOSE_LAST)?this.el.replaceClass(this.unorderList.CLASS_UL_HAS_CHILD_CLOSE_LAST,this.unorderList.CLASS_UL_HAS_NO_CHILD_LAST):this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_OPEN_MID)?this.el.replaceClass(this.unorderList.CLASS_UL_HAS_CHILD_OPEN_MID,this.unorderList.CLASS_UL_HAS_NO_CHILD_MID):this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_OPEN_LAST)&&this.el.replaceClass(this.unorderList.CLASS_UL_HAS_CHILD_OPEN_LAST,this.unorderList.CLASS_UL_HAS_NO_CHILD_LAST),Rui.get(this.getLi()).removeClass(this.unorderList.CLASS_UL_LI_LINE);break;case this.NODE_STATE.MID:this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_CLOSE_LAST)?this.el.replaceClass(this.unorderList.CLASS_UL_HAS_CHILD_CLOSE_LAST,this.unorderList.CLASS_UL_HAS_CHILD_CLOSE_MID):this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_OPEN_LAST)?(this.el.replaceClass(this.unorderList.CLASS_UL_HAS_CHILD_OPEN_LAST,this.unorderList.CLASS_UL_HAS_CHILD_OPEN_MID),Rui.get(this.getLi()).addClass(this.unorderList.CLASS_UL_LI_LINE)):this.el.hasClass(this.unorderList.CLASS_UL_HAS_NO_CHILD_LAST)&&this.el.replaceClass(this.unorderList.CLASS_UL_HAS_NO_CHILD_LAST,this.unorderList.CLASS_UL_HAS_NO_CHILD_MID);break;case this.NODE_STATE.LAST:this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_CLOSE_MID)?this.el.replaceClass(this.unorderList.CLASS_UL_HAS_CHILD_CLOSE_MID,this.unorderList.CLASS_UL_HAS_CHILD_CLOSE_LAST):this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_OPEN_MID)?this.el.replaceClass(this.unorderList.CLASS_UL_HAS_CHILD_OPEN_MID,this.unorderList.CLASS_UL_HAS_CHILD_OPEN_LAST):this.el.hasClass(this.unorderList.CLASS_UL_HAS_NO_CHILD_MID)&&this.el.replaceClass(this.unorderList.CLASS_UL_HAS_NO_CHILD_MID,this.unorderList.CLASS_UL_HAS_NO_CHILD_LAST),Rui.get(this.getLi()).removeClass(this.unorderList.CLASS_UL_LI_LINE);break;case this.NODE_STATE.OPEN:this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_CLOSE_MID)?(this.el.replaceClass(this.unorderList.CLASS_UL_HAS_CHILD_CLOSE_MID,this.unorderList.CLASS_UL_HAS_CHILD_OPEN_MID),Rui.get(this.getLi()).addClass(this.unorderList.CLASS_UL_LI_LINE)):this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_CLOSE_LAST)&&this.el.replaceClass(this.unorderList.CLASS_UL_HAS_CHILD_CLOSE_LAST,this.unorderList.CLASS_UL_HAS_CHILD_OPEN_LAST);break;case this.NODE_STATE.CLOSE:this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_OPEN_MID)?this.el.replaceClass(this.unorderList.CLASS_UL_HAS_CHILD_OPEN_MID,this.unorderList.CLASS_UL_HAS_CHILD_CLOSE_MID):this.el.hasClass(this.unorderList.CLASS_UL_HAS_CHILD_OPEN_LAST)&&this.el.replaceClass(this.unorderList.CLASS_UL_HAS_CHILD_OPEN_LAST,this.unorderList.CLASS_UL_HAS_CHILD_CLOSE_LAST),Rui.get(this.getLi()).removeClass(this.unorderList.CLASS_UL_LI_LINE);break;case this.NODE_STATE.MARK:this.el.addClass(this.unorderList.CLASS_UL_MARKED_NODE);break;case this.NODE_STATE.UNMARK:this.el.removeClass(this.unorderList.CLASS_UL_MARKED_NODE);break;case this.NODE_STATE.FOCUS:this.el.addClass(this.unorderList.CLASS_UL_FOCUS_NODE),(s=this.getParentNode())&&s.changeStateTo(this.NODE_STATE.FOCUS_PARENT);break;case this.NODE_STATE.UNFOCUS:this.el.removeClass(this.unorderList.CLASS_UL_FOCUS_NODE),(s=this.getParentNode())&&s.changeStateTo(this.NODE_STATE.UNFOCUS_PARENT);break;case this.NODE_STATE.FOCUS_PARENT:var s;this.el.addClass(this.unorderList.CLASS_UL_FOCUS_PARENT_NODE),(s=this.getParentNode())&&s.changeStateTo(this.NODE_STATE.FOCUS_PARENT);break;case this.NODE_STATE.UNFOCUS_PARENT:this.el.removeClass(this.unorderList.CLASS_UL_FOCUS_PARENT_NODE),s&&s.changeStateTo(this.NODE_STATE.UNFOCUS_PARENT);break;case this.NODE_STATE.FOCUS_TOP:for(var e=this.getUL(),i=0,r=e.childNodes.length;i<r;i++)e.childNodes[i].firstChild!==this.dom&&this.unorderList.getNodeObject(e.childNodes[i]).el.removeClass(this.unorderList.CLASS_UL_FOCUS_TOP_NODE);this.el.addClass(this.unorderList.CLASS_UL_FOCUS_TOP_NODE)}}});