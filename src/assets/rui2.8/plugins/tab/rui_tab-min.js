/*
 * @(#) rui_tab-min.js
 *
 * DevOn RUI
 * Build Version : 2.8
 * 
 * Copyright ⓒ LG CNS, Inc. All rights reserved.
 *
 * DevOn RUI의 모든 저작물은 LG CNS 의 지적재산입니다.
 * LG CNS로 부터 허가 받지 않은 경우 사용, 열람, 복사, 수정, 재배포 할 수 없으며 외부로의 유출을 금지합니다.
 * 특히 소스 코드를 수정하는 경우 기술 지원의 대상이 되지 않을 수 있습니다.
 * 자세한 사항은 계약사항에 따릅니다. 기타 사항은 devon@lgcns.com 으로 문의 하십시오.
 *
 * Do Not Erase This Comment!!! (이 주석문을 지우지 말것)
 *
 * rui/license.txt를 반드시 읽어보고 사용하시기 바랍니다. License.txt파일은 절대로 삭제하시면 안됩니다. 
 *
 * 1. 사내 사용시 KAMS를 통해 요청하여 사용허가를 받으셔야 소프트웨어 라이센스 계약서에 동의하는 것으로 간주됩니다.
 * 2. DevOn RUI가 포함된 제품을 판매하실 경우에도 KAMS를 통해 요청하여 사용허가를 받으셔야 합니다.
 * 3. KAMS를 통해 사용허가를 받지 않은 경우 소프트웨어 라이센스 계약을 위반한 것으로 간주됩니다.
 * 4. 별도로 판매될 경우는 LGCNS의 소프트웨어 판매정책을 따릅니다.
 * 
 * (추가) Plugin 하위 목록에 포함된 파일의 경우 프로젝트에서 임의로 customizing 해서 사용 가능합니다.
 * 단, 프로젝트에서 customizing 한 사항은 기술지원 대상 범위에서 제외됩니다.
 * 
 */
Rui.namespace("Rui.ui.tab"),Rui.ui.tab.LTabView=function(t){t=t||{},t=Rui.applyIf(t,Rui.getConfig().getFirst("$.ext.tabView.defaultProperties")),Rui.ui.tab.LTabView.superclass.constructor.call(this,t)},Rui.extend(Rui.ui.tab.LTabView,Rui.ui.LUIComponent,{otype:"Rui.ui.tab.LTabView",CSS_BASE:"L-tabview",CLASSNAME:"L-navset",_activatedTabs:null,contentHeight:null,ACTIVE:"active",tabCnt:1,ACTIVE_TAB:"activeTab",ACTIVE_INDEX:"activeIndex",tabs:null,_tabEl:null,_contentEl:null,changeTabsPosition:!1,initDefaultConfig:function(){Rui.ui.tab.LTabView.superclass.initDefaultConfig.call(this),this.cfg.addProperty("tabs",{value:[],readOnly:!0}),this.cfg.addProperty(this.ACTIVE_INDEX,{handler:this._setActiveIndex,value:this.activeIndex,validator:Rui.isNumber}),this.cfg.addProperty(this.ACTIVE_TAB,{handler:this._setActiveTab,value:this.b4ActiveTab,validator:this._isValidActiveTab}),this.cfg.addProperty("contentHeight",{handler:this._setContentHeight,value:this.contentHeight,validator:Rui.isNumber})},initEvents:function(){Rui.ui.tab.LTabView.superclass.initEvents.call(this),this.createEvent("canActiveTabChange"),this.createEvent("activeTabChange"),this.createEvent("activeIndexChange")},createContainer:function(t){var i,e,s=Rui.ui.tab.LTabView.superclass.createContainer.call(this,Rui.get(t)),a=0,n=s.parent();if((null==n||Rui.get(t).dom!==n.dom)&&0<(e=(i=Rui.get(t).getChildren()).length))for(a=0;a<e;a++)s.appendChild(i[a])},_setDisabled:function(t,i,e){Rui.ui.tab.LTabView.superclass._setDisabled.call(this,t,i,e),!1===i[0]?this.el.unmask():this.el.mask()},doRender:function(t){Rui.ui.tab.LTabView.superclass.doRender.call(t),this.el.addClass(this.CSS_BASE),this.el.addClass("L-navset");var i={},e="";this.changeTabsPosition&&(e="-bottom"),i["L-nav"]="L-nav"+e,i["L-content"]="L-content"+e,this.changeTabsPosition&&((h=document.createElement("div")).id=Rui.useFixedId()?Rui.id(this.el,this.id+"-content"):Rui.id(),this._contentEl=Rui.get(h),this._contentEl.addClass(i["L-content"]),this.el.appendChild(this._contentEl));var s=document.createElement("div");s.id=Rui.useFixedId()?Rui.id(this.el,this.id+"-nav-scroll"):Rui.id(),this._tabScrollEl=Rui.get(s),this._tabScrollEl.addClass("L-nav-scroll"),this.el.appendChild(this._tabScrollEl);var a=document.createElement("ul");a.id=Rui.useFixedId()?Rui.id(this.el,this.id+"-nav"):Rui.id(),this._tabEl=Rui.get(a),this._tabEl.addClass(i["L-nav"]),Rui.useAccessibility()&&this._tabEl.setAttribute("role","tablist"),this._tabScrollEl.appendChild(this._tabEl);var n=document.createElement("div");n.id=Rui.useFixedId()?Rui.id(this.el,this.id+"-nav-spin-left"):Rui.id(),this._tabLeftSpinerEl=Rui.get(n),this._tabLeftSpinerEl.addClass("L-nav-spin-left"),this._tabLeftSpinerEl.on("click",this.onSpinLeftClick,this,!0),this._tabScrollEl.appendChild(this._tabLeftSpinerEl);var l=document.createElement("div");l.id=Rui.useFixedId()?Rui.id(this.el,this.id+"-nav-spin"):Rui.id(),this._tabSpinEl=Rui.get(l),this._tabSpinEl.addClass("L-nav-spin"),this._tabScrollEl.appendChild(this._tabSpinEl);var h,r=document.createElement("div");r.id=Rui.useFixedId()?Rui.id(this.el,this.id+"-nav-spin-right"):Rui.id(),this._tabRightSpinerEl=Rui.get(r),this._tabRightSpinerEl.addClass("L-nav-spin-right"),this._tabRightSpinerEl.on("click",this.onSpinRightClick,this,!0),this._tabScrollEl.appendChild(this._tabRightSpinerEl),this.changeTabsPosition||((h=document.createElement("div")).id=Rui.useFixedId()?Rui.id(this.el,this.id+"-content"):Rui.id(),this._contentEl=Rui.get(h),this._contentEl.addClass(i["L-content"]),this.el.appendChild(this._contentEl)),this._tabSpinEl.appendChild(this._tabEl),this._activatedTabs=[],null==this.tabs?this.addTabsByChild(this.el.dom):this.addTabs(this.tabs),this.currentVisibleTabIndex=0},afterRender:function(t){Rui.ui.tab.LTabView.superclass.afterRender.call(this,t),this.set("tabs",this.tabs),this.reMon||null!=this.width||(this.reMon=new Rui.util.LResizeMonitor,this.reMon.monitor(this.el.dom),this.reMon.on("contentResized",this.onContentResized,this,!0)),Rui.browser.msie&&null==this.width&&Rui.later(1e3,this,this.onContentResized)},updateTabs:function(){0<this.el.getWidth()&&this._tabEl.getWidth()>this.el.getWidth()?(this._useScroll=!0,this._tabLeftSpinerEl&&(this._tabLeftSpinerEl.addClass("enable"),this._tabSpinEl.addClass("enable"),this._tabRightSpinerEl.addClass("enable"))):(this._useScroll=!1,this._tabLeftSpinerEl&&(this._tabLeftSpinerEl.removeClass("enable"),this._tabSpinEl.removeClass("enable"),this._tabRightSpinerEl.removeClass("enable")))},onSpinLeftClick:function(t){var i,e,s=this.tabs,a=s.length,n=this._tabEl.dom.offsetLeft;if(n<0){for(i=0;i<a&&s[i].el.offsetLeft<-1*n;i++)e=i;null!=e&&this.moveTo(e,!0)}},onSpinRightClick:function(t){for(var i,e=this.tabs,s=e.length,a=this._tabEl.dom.offsetLeft,n=this._tabSpinEl.getWidth(),l=0;l<s&&e[l].el.offsetLeft+e[l].el.offsetWidth<=n-a;l++)i=l;null!=i&&(i=++i<s-1?i:s-1,this.moveTo(i,!0))},onContentResized:function(t){this.updateTabs(),this.moveTo(this.getActiveIndex(),!1)},_setActiveIndex:function(t,i,e){var s,a=i[0],n=this.b4ActiveTab,l=this.getTab(a);l&&0!=this.fireEvent("canActiveTabChange",{target:this,activeIndex:a,activeTab:l,beforeActiveTab:n})&&(s=this._addTabStatus(a),n&&n.set(this.ACTIVE,!1),l&&l.set(this.ACTIVE,!0),l&&n!==l?this.contentTransition(l):l&&l.set("contentVisible",!0),this.moveTo(a,!0),this.fireEvent("activeTabChange",{target:this,activeIndex:a,isFirst:s,activeTab:l,beforeActiveTab:n,newValue:l,prevValue:n}),this.fireEvent("activeIndexChange",{target:this,activeIndex:a,isFirst:s,activeTab:l,beforeActiveTab:n}),this.b4ActiveTab=l)},_setActiveTab:function(t,i,e){this.set(this.ACTIVE_INDEX,this.getTabIndex(i[0]))},_addTabStatus:function(t){var i=this._activatedTabs;if(!i)return!1;for(var e=0,s=i.length;e<s;e++)if(void 0!==i[e]&&void 0!==i[e].tabIndex&&i[e].tabIndex==t)return!(i[e].isActived=!0);return i.push({tabIndex:t,isActived:!0}),!0},_removeTabStatus:function(t){var i=this._activatedTabs;for(prop in i)if(i.hasOwnProperty(prop)&&i[prop].tabIndex===t)return void delete i[prop]},_setHeight:function(t,i,e){this.el.setHeight(i[0]);var s=this._tabEl.getHeight();this._contentEl.setHeight(i[0]-s)},_setContentHeight:function(t,i,e){var s=i[0];if(this.contentHeight)this._contentEl.setHeight(s);else{this.contentHeight=s;var a=this._tabEl.getHeight();if(s<(a||1))return;this.setHeight(s+a)}},addTabsByChild:function(t){if(!this._childAdded){var i=!0,e=t.childNodes;if(0<e.length){var s,a=[],n=0;for(len=e.length;n<len;n++)(s=e[n]).tagName&&"div"==s.tagName.toLowerCase()&&(!s.className||s.className.indexOf("L-")<0)&&a.push(s);for(n=0,len=a.length;n<len;n++){var l=a[n].title;this.addTab(new Rui.ui.tab.LTab({label:l,contentEl:a[n],active:i,tabView:this})),i=!1}this.tabs=this.get("tabs")}}this._childAdded=!0},removeTab:function(t){var i,e,s;t&&void 0!==t.el&&(i=this.get("tabs"),e=this.getTabIndex(t),s=this.get(this.ACTIVE_INDEX),i.splice(e,1),this._tabEl.removeChild(t.el),this._contentEl.removeChild(t.get(t.CONTENT_EL)),1==this._rendered&&this.updateTabs(),i.length<1?this.set(this.ACTIVE_INDEX,-1):e===s&&this.set(this.ACTIVE_INDEX,0<e?e-1:0),null!=s&&this.moveTo(this.get(this.ACTIVE_INDEX),!0),t.fireEvent("remove",{type:"remove",tabview:this},this,!0))},contentTransition:function(t){for(var i=this.get("tabs"),e=0,s=i.length;e<s;e++)t===i[e]?t.set("contentVisible",!0):i[e].set&&i[e].set("contentVisible",!1)},_isValidActiveTab:function(t){if(void 0===t||null==t)return!1;var i=!0;return t&&t.get("disabled")&&(i=!1),i},set:function(t,i,e){return this.cfg.setProperty(t,i,e)},get:function(t){return this.cfg.getProperty(t)},setContentHeight:function(t){this.set("contentHeight",t)},getTab:function(t){return this.get("tabs")[t]},getTabIndex:function(t){for(var i=null,e=this.get("tabs"),s=0,a=e.length;s<a;++s)if(t==e[s]){i=s;break}return i},getTabCount:function(){return this.get("tabs").length},selectTab:function(t){this.set(this.ACTIVE_INDEX,t)},addTabs:function(t){if(t&&0<t.length){var i=t.length;this.tabs=[],this.set("tabs",this.tabs);for(var e=0;e<i;e++)t[e].tabView=this,t[e]instanceof Rui.ui.tab.LTab?this.addTab(t[e]):this.addTab(new Rui.ui.tab.LTab(t[e]));this.tabs=this.get("tabs")}},addTab:function(t,i){if(!this._tabEl)return this.tabs||(this.tabs=[]),void this.tabs.push(t);var e,s=this.get("tabs"),a=null!=i?s[i]:null,n=this._tabEl.dom,l=t.el,h=this._contentEl.dom,r=t.get(t.CONTENT_EL);if(i=null!=i?i:s.length,Rui.get(r).addClass(t.CONTENT_CLASSNAME),a?(n.insertBefore(l,a.el),s.splice(i,0,t),e=i+1):(n.appendChild(l),s.push(t)),h&&r&&!Rui.util.LDom.isAncestor(h,r)&&h.appendChild(r),t.get(this.ACTIVE)){for(var o=0,d=s.length;o<d;o++)s[o].set&&o!==i&&s[o].set("active",!1);this.set(this.ACTIVE_INDEX,i),this._rendered=!0,this.updateTabs(),this.moveTo(i,!0)}else t.set("contentVisible",!1,!1),null!=e&&this.set(this.ACTIVE_INDEX,e),this._rendered=!0,this.updateTabs(),null!=e&&this.moveTo(e,!0);t.tabView=this,t.el&&Rui.get(t.el).addListener(t.get("activationEvent"),t.onActivate,t,!0),Rui.useAccessibility()&&(r.setAttribute("role","tabpanel"),r.setAttribute("aria-labelledby",t.el.id),t.el.setAttribute("aria-controls",r.id))},moveTo:function(t,i){var e,s,a,n,l,h;this.tabs&&0!=this.tabs.length&&(e=this.tabs[t],s=this._tabEl.dom.offsetLeft-this._tabEl.getMargins("l"),a=this._tabSpinEl.getWidth(),l=(n=e.el.offsetLeft)+e.el.offsetWidth,this._tabEl.getWidth(),!(h=0)===this._useScroll?a<=l+s?h=-l+a:n<=-s?h=-n:-s<n&&a-(h=s)>this._tabEl.getWidth()&&(h+=a-s-this._tabEl.getWidth()):h=0,s!=h&&(!0!==i||Rui.platform.isMobile?this._tabEl.setLeft(h):new Rui.fx.LAnim({el:this._tabEl.dom,attributes:{left:{from:s,to:h}},duration:.3}).animate()))},removeAt:function(t){this._removeTabStatus(t),this.removeTab(this.getTab(t))},getActiveIndex:function(){return this.get(this.ACTIVE_INDEX)},getActiveTab:function(){return this.getTab(this.get(this.ACTIVE_INDEX))},destroy:function(){this._activatedTabs=null,this._tabLeftSpinerEl&&(this._tabLeftSpinerEl.unOnAll(),this._tabLeftSpinerEl.remove(),delete this._tabLeftSpinerEl),this._tabSpinEl&&(this._tabSpinEl.remove(),delete this._tabSpinEl),this._tabRightSpinerEl&&(this._tabRightSpinerEl.unOnAll(),this._tabRightSpinerEl.remove(),delete this._tabRightSpinerEl),this._tabScrollEl&&(this._tabScrollEl.remove(),delete this._tabScrollEl),this._tabEl&&(this._tabEl.remove(),delete this._tabEl),this._contentEl&&(this._contentEl.remove(),delete this._contentEl),Rui.ui.tab.LTabView.superclass.destroy.call(this)},toString:function(){return"Rui.ui.tab.LTabView "+this.id}}),function(){var n=Rui.util.LDom;Rui.ui.tab.LTab=function(t){var i;!(t=t||{}).id||(i=Rui.get(t.id))&&i.dom&&(t.contentEl=i.dom),t.element||(this.el=this.createElement(t)),Rui.applyObject(this,t,!0),Rui.ui.tab.LTab.superclass.constructor.call(this,t),this.init(t)},Rui.extend(Rui.ui.tab.LTab,Rui.util.LEventProvider,{otype:"Rui.ui.tab.LTab",label:null,LABEL:"label",LABEL_EL:"labelEl",CONTENT:"content",CONTENT_EL:"contentEl",contentEl:null,DISABLED:"disabled",LABEL_TAGNAME:"em",ACTIVE_CLASSNAME:"L-nav-selected",CONTENT_CLASSNAME:"L-content-tab",HIDDEN_CLASSNAME:"L-nav-hidden",ACTIVE_TITLE:"active",DISABLED_CLASSNAME:"disabled",init:function(t){this.initDefaultConfig(),t&&this.cfg.applyConfig(t,!0),this.cfg.setProperty("disabled",!Rui.isUndefined(t.disabled)&&t.disabled),this.cfg.setProperty("activationEvent",this.activationEvent||"click"),this.cfg.setProperty(this.LABEL,this.label),void 0!==this[this.CONTENT]&&this.cfg.setProperty(this.CONTENT_EL,document.createElement("div")),!Rui.isUndefined(this.tabView)&&this.tabView.changeTabsPosition&&(this.ACTIVE_CLASSNAME="L-nav-bottom-selected"),this.cfg.setProperty(this.CONTENT,this.content),this.cfg.setProperty("active",this.active||this.hasClass(this.ACTIVE_CLASSNAME)),this.cfg.setProperty("contentVisible",this.active||this.contentVisible)},initDefaultConfig:function(){this.cfg=new Rui.ui.LConfig(this),this.cfg.addProperty("activationEvent",{value:this.activationEvent||"click"}),this.cfg.addProperty(this.LABEL,{handler:this._setLabel,value:this.label||this._getLabel()}),this.cfg.addProperty(this.LABEL_EL,{handler:this._setLabelEl,value:this[this.LABEL_EL]||this._getLabelEl()}),this.cfg.addProperty(this.CONTENT_EL,{handler:this._setContentEl,value:this.get(this.CONTENT_EL)||this[this.CONTENT_EL]||document.createElement("div")}),this.cfg.addProperty(this.CONTENT,{handler:this._setContent,value:this[this.CONTENT]},!1),this.cfg.addProperty(this.ACTIVE_TITLE,{handler:this._setActiveTitle,value:this.active||this.hasClass(this.ACTIVE_CLASSNAME),validator:Rui.isBoolean}),this.cfg.addProperty(this.DISABLED,{handler:this._setDisabled,value:this.disabled||this.hasClass(this.DISABLED_CLASSNAME),validator:Rui.isBoolean}),this.cfg.addProperty("contentVisible",{handler:this._setContentVisible,value:this.contentVisible,validator:Rui.isBoolean})},getContainer:function(){return this.el},createElement:function(t){var i=document.createElement("li"),e=document.createElement("a"),s=t.label||null,a=t.labelEl||null;return i.id=Rui.useFixedId()&&!Rui.isUndefined(t.tabView)?Rui.id(this.el,t.tabView.id+"-LTab-"+t.tabView.tabCnt++):Rui.id(),e.href=t.href||"#",Rui.useAccessibility()&&i.setAttribute("role","tab"),i.appendChild(e),a?s=s||this._getLabel():a=this._createLabelEl(),e.appendChild(a),i},addClass:function(t){return n.addClass(this.el,t),this},hasClass:function(t){return n.hasClass(this.el,t)},removeClass:function(t){var i=Rui.isArray(t)?t:[t];return Rui.util.LArray.each(i,function(t){n.removeClass(this.el,t)},this),this},_setContentVisible:function(t,i,e){i[0]?(n.removeClass(this.get(this.CONTENT_EL),this.HIDDEN_CLASSNAME),Rui.useAccessibility()&&this.get(this.CONTENT_EL).setAttribute("aria-hidden","false"),Rui.browser.msies&&setTimeout(function(){contentDom.style.paddingRight="0px"},10)):(n.addClass(this.get(this.CONTENT_EL),this.HIDDEN_CLASSNAME),Rui.useAccessibility()&&this.get(this.CONTENT_EL).setAttribute("aria-hidden","true"),Rui.browser.msies&&(contentDom.style.paddingRight="1px"))},_setDisabled:function(t,i,e){!0===i[0]?n.addClass(this.el,this.DISABLED_CLASSNAME):n.removeClass(this.el,this.DISABLED_CLASSNAME)},_setActiveTitle:function(t,i,e){!0===i[0]?(this.addClass(this.ACTIVE_CLASSNAME),this.set("title",this.ACTIVE_TITLE),Rui.useAccessibility()&&this.el.setAttribute("aria-selected","true")):(this.removeClass(this.ACTIVE_CLASSNAME),this.set("title",""),Rui.useAccessibility()&&this.el.setAttribute("aria-selected","false"))},_setContent:function(t,i,e){var s=i[0],a=document.createElement("div");Rui.util.LDom.appendHtml(a,s)},_setContentEl:function(t,i,e){var s=i[0],a=this.get(this.CONTENT);if(a){if(a===s)return!1;this.get("selected")||n.addClass(s,this.HIDDEN_CLASSNAME),Rui.get(s).html(a),this.set(this.CONTENT,s.innerHTML)}},_setLabel:function(t,i,e){var s=this.get(this.LABEL_EL);s||(s=this._createLabelEl(),this.set(this.LABEL_EL,s)),Rui.get(s).html(i[0])},_setLabelEl:function(t,i,e){var s=n.get(i[0]),a=this.get(this.LABEL_EL);if(a){if(a==s)return!1;a.parentNode.replaceChild(s,a),this.set(this.LABEL,s.innerHTML)}},get:function(t){return this.cfg.getProperty(t)},set:function(t,i,e){return this.cfg.setProperty(t,i,e)},_getLabelEl:function(){return this.el.getElementsByTagName(this.LABEL_TAGNAME)[0]},_createLabelEl:function(){return document.createElement(this.LABEL_TAGNAME)},_getLabel:function(){var t=this.get(this.LABEL_EL);if(t)return t.innerHTML},onActivate:function(t){var i,e;!0!==this.cfg.getProperty(this.DISABLED)&&(i=!1,e=this.tabView.getTabIndex(this),this===this.tabView.b4ActiveTab&&(i=!0),this.tabView.set(this.tabView.ACTIVE_INDEX,e,i),Rui.util.LEvent.preventDefault(t))},setLabel:function(t){this.set(this.LABEL,t)},getLabel:function(){return this.get(this.LABEL)},setDisabled:function(t){this.cfg.setProperty(this.DISABLED,t)},getDisabled:function(){return this.cfg.getProperty(this.DISABLED)},destroy:function(){this.el=null,this.cfg=null,Rui.ui.tab.LTab.superclass.destroy.call(this)},toString:function(){return"Rui.ui.tab.LTab "+(el.id||this.id)}})}();