/*
 * @(#) LSimpleCalendar-min.js
 * 
 * DevOn RUI
 * Build Version : 2.8
 * 
 * Copyright ⓒ LG CNS, Inc. All rights reserved.
 *
 * DevOn RUI의 모든 저작물은 LG CNS 의 지적재산입니다.
 * LG CNS로 부터 허가 받지 않은 경우 사용, 열람, 복사, 수정, 재배포 할 수 없으며 외부로의 유출을 금지합니다.
 * 특히 소스 코드를 수정하는 경우 기술 지원의 대상이 되지 않을 수 있습니다.
 * 자세한 사항은 계약사항에 따릅니다. 기타 사항은 devon@lgcns.com 으로 문의 하십시오.
 *
 * Do Not Erase This Comment!!! (이 주석문을 지우지 말것)
 *
 * rui/license.txt를 반드시 읽어보고 사용하시기 바랍니다. License.txt파일은 절대로 삭제하시면 안됩니다. 
 *
 * 1. 사내 사용시 KAMS를 통해 요청하여 사용허가를 받으셔야 소프트웨어 라이센스 계약서에 동의하는 것으로 간주됩니다.
 * 2. DevOn RUI가 포함된 제품을 판매하실 경우에도 KAMS를 통해 요청하여 사용허가를 받으셔야 합니다.
 * 3. KAMS를 통해 사용허가를 받지 않은 경우 소프트웨어 라이센스 계약을 위반한 것으로 간주됩니다.
 * 4. 별도로 판매될 경우는 LGCNS의 소프트웨어 판매정책을 따릅니다.
 */
Rui.ui.calendar.LSimpleCalendar=function(e){var t=e||{};Rui.ui.calendar.LSimpleCalendar.superclass.constructor.call(this,t),this.createEvent("cellRendered"),this.createEvent("beforeSelect"),this.createEvent("select"),this.createEvent("beforeDeselect"),this.createEvent("deselect")},Rui.extend(Rui.ui.calendar.LSimpleCalendar,Rui.ui.LUIComponent,{otype:"Rui.ui.calendar.LSimpleCalendar",CSS_BASE:"L-calendar",startWeekDay:0,pagedate:new Date,locale:"ko_KR",valueDateLocale:Rui.util.LDateLocale.en_US,dateLocale:null,selectedDate:null,initComponent:function(e){this.createTemplate(),this.dateLocale=Rui.util.LDateLocale.getInstance(this.locale),this.pagedate||(pagedate=new Date)},createTemplate:function(){var e=this.templates||{};e.master||(e.master=new Rui.LTemplate('<div class="L-calendar-header" >','<div class="L-calendar-header-offset" >{header}</div>',"</div>",'<div class="L-calendar-body" >','<div class="L-calendar-body-offset"></div>',"</div>",'<div class="L-calendar-footer">{footer}</div>','<a class="L-calendar-focus" tabindex="-1" onclick="return false" href="#">{footer}</a>')),e.header||(e.header=new Rui.LTemplate('<a href="#" class="L-calendar-header-year-left"><<</a>','<a href="#" class="L-calendar-header-month-left"><</a>','<a href="#" class="L-calendar-header-body">{year} {month}</a>','<a href="#" class="L-calendar-header-month-right">></a>','<a href="#" class="L-calendar-header-year-right">>></a>')),e.body||(e.body=new Rui.LTemplate('<ul class="L-calendar-dates">{cellHeader}{cellBody}</ul>')),e.cellHeader||(e.cellHeader=new Rui.LTemplate('<li class="L-calendar-date-header {dayOfTheWeek}">{dayOfTheWeekLocale}</li>')),e.cellBody||(e.cellBody=new Rui.LTemplate('<li class="L-calendar-date {day} {css} ">{date}</li>')),e.footer||(e.footer=new Rui.LTemplate('<a href="#" class="L-calendar-footer-close">close</a>')),this.templates=e},doRender:function(e){this.renderMaster(this.getRenderHeader(),"",this.getRenderFooter()),this.el.addClass(this.CSS_BASE),this.el.addClass("L-fixed"),this.el.on("click",this.focusCalendar,this,!0),this.headerEl=this.el.select(".L-calendar-header").getAt(0),this.headerOffsetEl=this.el.select(".L-calendar-header-body").getAt(0),this.bodyEl=this.el.select(".L-calendar-body").getAt(0),this.bodyOffsetEl=this.el.select(".L-calendar-body-offset").getAt(0),this.footerEl=this.el.select(".L-calendar-footer").getAt(0),this.focusEl=this.el.select(".L-calendar-focus").getAt(0),this.renderBody(this.getRenderBody()),this.focusEl.on("focus",this.onCheckFocus,this,!0),this.headerEl.on("click",this.onHeaderClick,this,!0),this.bodyEl.on("click",this.onBodyClick,this,!0)},renderMaster:function(e,t,a){var l=this.templates.master.apply({header:e,body:t,footer:a});this.el.html(l)},renderHeader:function(e){this.headerEl.html(e)},renderBody:function(e){this.bodyOffsetEl.html(e);for(var t=this.renderStartDate.clone(),a=this.bodyOffsetEl.query(".L-calendar-date"),l=0;l<a.length;l++){var s={cell:a[l],date:t};this.fireEvent("cellRendered",s),t=t.add("D",1)}},getRenderHeader:function(){var e=this.templates||{},t={year:this.pagedate.format("%Y"),month:this.pagedate.format("%m")};return e.header.apply(t)},getRenderBody:function(){var e=this.templates||{},t={cellHeader:this.getRenderCellHeaderRows(),cellBody:this.getRenderCellBodyRows()};return e.body.apply(t)},getRenderCellHeaderRows:function(){for(var e="",t=this.startWeekDay,a=0;a<7;a++,t++)e+=this.getRenderCellHeader(t),t=6==t?-1:t;return e},getRenderCellHeader:function(e){var t=this.templates||{},a={dayOfTheWeek:this.valueDateLocale.A[e],dayOfTheWeekLocale:this.dateLocale.a[e]};return t.cellHeader.apply(a)},getRenderCellBodyRows:function(){for(var e="",t=(this.startWeekDay,6-this.startWeekDay),a=new Date(this.pagedate.getFullYear(),this.pagedate.getMonth(),1),l=(this.pagedate.getLastDayOfMonth(),0);l<7&&a.getDay()!=this.startWeekDay;l++)a=a.add("D",-1);this.renderStartDate=a.clone();for(var s=!1,l=0;l<100&&(e+=this.getRenderCellBody(a),!s||a.getDay()!=t);l++)a=a.add("D",1),this.pagedate.getMonth()==a.getMonth()&&this.pagedate.getDayInMonth().getDate()==a.getDate()&&(s=!0);return e},getRenderCellBody:function(e){var t=this.templates||{},a=["L-date-"+e.format("%Y%m%d"),e.equals(this.pagedate,{format:"%y%m"})?"":"L-disable-date"],l={day:this.valueDateLocale.A[e.getDay()],date:e.getDate(),css:a.join(" ")};return t.cellBody.apply(l)},getRenderFooter:function(){return(this.templates||{}).footer.apply({})},focusCalendar:function(e){this.focusEl.focus()},onHeaderClick:function(e){var t=Rui.get(e.target);t.hasClass("L-calendar-header-year-left")?this.setYear(this.pagedate.getFullYear()-1):t.hasClass("L-calendar-header-month-left")?this.setMonth(this.pagedate.getMonth()-1):t.hasClass("L-calendar-header-month-right")?this.setMonth(this.pagedate.getMonth()+1):t.hasClass("L-calendar-header-year-right")&&this.setYear(this.pagedate.getFullYear()+1)},onBodyClick:function(e){var t=Rui.get(e.target);if(t.hasClass("L-calendar-date")){if(t.hasClass("L-disable-date"))return;1==this.doDeselectCell(e,this)&&this.doSelectCell(e,this)}},setMonth:function(e){this.pagedate.setMonth(e),this.renderHeader(this.getRenderHeader()),this.renderBody(this.getRenderBody())},setYear:function(e){this.pagedate.setFullYear(e),this.renderHeader(this.getRenderHeader()),this.renderBody(this.getRenderBody())},doSelectCell:function(e,t){var a=Rui.get(e.target),l=this.getCssToDate(a.dom);0!=this.fireEvent("beforeSelect",{date:l})&&(a.addClass("selected"),this.fireEvent("select",{date:l}),this.selectedDate=l)},doDeselectCell:function(e,t){if(null!=this.selectedDate){if(0==this.fireEvent("beforeSelect",{date:this.selectedDate}))return!1;var a=this.selectedDate.clone();this.clear(),this.fireEvent("deselect",{date:a})}return!0},getCssToDate:function(e){for(var t=e.className.split(" "),a=0;a<t.length;a++)if(t[a].startsWith("L-date-"))return t[a].substring(7).toDate("%Y%m%d");return null},clear:function(){this.bodyEl.select(".selected").removeClass("selected"),this.selectedDate=null},focus:function(){this.focusCalendar()},destroy:function(){this.headerEl.remove(),this.headerOffsetEl.remove(),this.bodyEl.remove(),this.bodyOffsetEl.remove(),this.footerEl.remove(),this.focusEl.remove(),this.headerEl=null,this.headerOffsetEl=null,this.bodyEl=null,this.bodyOffsetEl=null,this.footerEl=null,this.focusEl=null,Rui.ui.calendar.LSimpleCalendar.superclass.destroy.call(this)}});